---
title: CycleGAN - A Simple Introduction to Image Transformation
tags: [abc of ai, theory]
image:
style: 
color: 
description: CycleGAN is a technique used for training  unpaired image-to-image translation models via the GAN (generative adversarial network) architecture.
---


<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/aedrian-hGDoyIFADHo-unsplash.jpg" class="figure-img img-fluid rounded" alt="" style="width:30%">
  <figcaption class="figure-caption text-center"> Photo by <a href="https://unsplash.com/@aedrian?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Aedrian</a> on <a href="https://unsplash.com/photos/hGDoyIFADHo?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a>
   </figcaption>
</figure>


Do you consider yourself as a creative person? Maybe you wander around the streets and wonder how the houses around you would look like as a painting. Or, instead of having horses galloping on the beach, imagine they were zebras? What if I told you that this is possible without the need of psychedelics. Instead, you can use CycleGAN!

CycleGAN is a technique used to transform one image into another. This post will teach you all the basics about it. I will cover the model architecture, the loss functions used to train CycleGAN, the type of data CycleGAN can be trained on, and then conclude with some applications.

#### 1. CycleGAN

[CycleGAN](https://arxiv.org/abs/1703.10593) was introduced in 2017 by a group of researchers from the Berkeley AI (Artifial Intelligence) Research laboratory. In its simplest explanation, CycleGAN is a type of {% include elements/highlight.html text="deep learning model" %} used for image-to-image translation tasks, meaning it can be used to turn pictures of one thing into pictures of another thing. For example, CycleGAN can transform a picture of a horse into a picture of a zebra while keeping the same context.


<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_01_horse_zebra.png" class="figure-img img-fluid rounded" alt="" style="width:80%">
  <figcaption class="figure-caption text-center"> CycleGAN example: horse transformed to zebra. 
  <br>Taken from: "Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks" </figcaption>
</figure>



The {% include elements/highlight.html text="neural network" %} in CycleGAN looks at a lot of pictures of horses and zebras and tries to pick up on what makes them different. It learns to recognize the features and patterns of each animal.

Then comes the interesting part. The neural network learns how to transform a horse picture into a zebra picture by changing the features and patterns in just the right way. It's like taking a picture of a horse and giving it stripes and colours to make it look like a zebra.

But it doesn't stop there. CycleGAN can also go the other way. It can take a zebra picture and turn it into a horse picture. Hence the name “CycleGAN”, as it can go in a cycle. Zebra to horse and horse to zebra.

<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_02_zebra_horse.png" class="figure-img img-fluid rounded" alt="" style="width:80%">
  <figcaption class="figure-caption text-center"> CycleGAN example: zebra transformed to horse. 
  <br>Taken from: "Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks" </figcaption>
</figure>





#### 2. CycleGAN Architecture

For illustration purposes we have collection 1 (photos of horses) and collection 2 (photos of zebras). 

<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_gans.png" class="figure-img img-fluid rounded" alt="" style="width:50%">
  <figcaption class="figure-caption text-center"> CycleGAN uses two GANs working in tandem </figcaption>
</figure>


CycleGAN is built using two GANs (Generative Adversarial Networks), where each does the following:
-	GAN1: translates photos of collection 1 (horses) to collection 2 (zebras)
-	GAN2: translates photos of collection 2 (zebras) to collection 1 (horses)

Each GAN is made up of two neural networks: the generator (which transforms horses to zebras and vice versa) and the discriminator (which tries to tell if the images are real or fake). The generator wants to create images so realistic that the discriminator cannot tell if they are real (from the original domain) or fake (generated by the generator).


#### 3. Loss Function

To measure how good or bad the network is doing at the task, loss functions are used. Without diving into the mathematical details, the purpose of loss functions are *yada yada*

CycleGAN is trained using different losses: the adversarial loss and the cycle consistency loss.

The adversarial loss involves the generators and discriminators in CycleGAN. It helps the generator get better at creating realistic images, fooling the discriminator.

The cycle consistency loss ensures that when you take an image from one domain, transform it to the other domain, and then change it back, you get something very close to the original image. This is like making sure the transformations are "consistent" and that you don't lose important information during the process.


#### 4. Unpaired Data

What makes CycleGAN so special is that it is one of the first models to use unpaired data during the training process.

Given two collections (datasets), paired data is data where a one-to-one correspondence between collection 1 and collection 2 exists. Unpaired data, on the other hand, is data where there is no direct one-to-one correspondence between the collections.

<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_unpaired_paired.png" class="figure-img img-fluid rounded" alt="" style="width:100%">
  <figcaption class="figure-caption text-center"> (left) Example of paired data: for each day image, the same image in night exists. (right) Example of unpaired data: no information is provided as to which image of apple matches with orange. 
  <br> Images from day and night collections are taken from: "Image-to-Image Translation with Conditional Adversarial Networks"  </figcaption>
</figure>

Collecting paired data can be impractical, costly and time consuming in many cases, as a direct correspondence is needed between the datasets. CycleGAN's ability to work with unpaired data makes this model so much more flexible and practical. 

I have been mainly talking about paintings and houses and horses and zebras, and you might ask yourself: what are the practical implications of unpaired vs. paired data?

Well in medical fields, this has significant implications. An example is to synthesize CT (computed tomography) images from MRI (magnetic resonance imaging) images. Both medical imaging techniques provide different details and have their advantages and disadvantages. 

MRI is radiation-free, provides high contrast (can detect slight differences) of soft tissues, ligaments, or organs. However, MRI is more expensive and slower compared to CT scans. Besides, it is advised that patients that are claustrophobic, have a cardiac pacemakers, or artificial joints, should not undergo MRI.

CT scans, on the other hand, provide detailed anatomic information of bones and other structures, is a lot faster than MRI, and is more desirable for patients who are contraindicated because of claustrophobia, cardiac pacemakers, and artificial joints. However, CT scans do not provide enough contrast of soft tissue and increase the radiation exposure for patients.


Both imaging techniques can complement each other to assist in better diagnosis and treatment. Estimating a MRI from a CT scan and vice-versa is desirable. If working with paired data, you would need to have for each MRI scan a corresponding CT counterpart, which also means higher radiation exposure to patients. Thanks to CycleGAN's flexibility, estimating MRI from CT scans and vice versa results in reducing clinical workload. If you are interested in this research, you can check out these studies from [Wolterink and colleagues](https://link.springer.com/chapter/10.1007/978-3-319-68127-6_2) and [Jin and colleagues](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6566351/).

<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_application_ctmri.jpeg" class="figure-img img-fluid rounded" alt="" style="width:80%">
  <figcaption class="figure-caption text-center">  Paired vs unpaired data of CT and MRI slices.
  <br> Taken from: "Deep CT to MR Synthesis Using Paired and Unpaired Data"  </figcaption>
</figure>



#### 5. Applications

CycleGAN's  versatility is showcased by the variety of applications such as:

- Style Transfer: CycleGAN can be used to transfer the style of an image from one domain to another. For example, it can convert photos of your house into the style of famous paintings.

<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_application_styletransfer.png" class="figure-img img-fluid rounded" alt="" style="width:70%">
  <figcaption class="figure-caption text-center">  Example of style transfer from a photograph of a landscape to different painting styles.
  <br> Taken from: "Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks"   </figcaption>
</figure>


-	Object Transfiguration: involves transforming an object in an image to resemble another object while preserving the overall scene context. It is a specialized form of image-to-image translation that focuses on changing the appearance of a specific object within an image, such as dogs into another class of objects, such as cats; or apples into oranges and vice versa.

<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_application_objecttransfiguration.png" class="figure-img img-fluid rounded" alt="" style="width:30%">
  <figcaption class="figure-caption text-center">  Example of object transfiguration from oranges to apples.
  <br> Taken from: "Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks"   </figcaption>
</figure>


-	Image Enhancement: It can be used to enhance image quality, upscale low-resolution images to higher resolutions, or improve image sharpness and clarity. The CycleGAN is demonstrated on photo enhancement by improving the depth of field (e.g. giving a macro effect) on close-up photographs of flowers.

<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_application_imageenhancement.png" class="figure-img img-fluid rounded" alt="" style="width:20%">
  <figcaption class="figure-caption text-center">  Example of image enhancement improving the depth of field on a photo of a flower.
  <br> Taken from: "Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks"   </figcaption>
</figure>


-	Season Transfer: CycleGAN can transform images taken in one season (e.g., summer) into images that look like they were captured in a different season (e.g., winter).

<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_application_seasontransfer.png" class="figure-img img-fluid rounded" alt="" style="width:40%">
  <figcaption class="figure-caption text-center">  Example of season transfer from summer to winter.
  <br> Taken from: "Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks"   </figcaption>
</figure>

- Faces-to-Ramen: I mean... why not? As a ramen lover myself, I have always wondered what I would look like as ramen. This translation was performed by [Takuya Kato](https://sites.google.com/site/liltak2takuyakato/).

<figure>
  <img src="{{site.baseurl}}/assets/img/post_cyclegan/cyclegan_application_faceramen.jpeg" class="figure-img img-fluid rounded" alt="" style="width:40%">
  <figcaption class="figure-caption text-center">  Example of season transfer from summer to winter.
  <br> Created by Takuya Kato, taken from: CycleGAN Project Page </figcaption>
</figure>


- Other applications include, Night-to-Day Conversion, Satellite-to-Map Translation, etc. For more information, have a look at the [CycleGAN Project Page](https://junyanz.github.io/CycleGAN/).

CycleGAN is flexible and cost-effective and can be applied to a wide range of image domains and can be used in various fields, such as computer vision, art, graphics, and medical imaging. 

#### Final Words
 

Your imagination, CycleGAN's creation!


___


##### Resource(s)

- [Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks](https://arxiv.org/abs/1703.10593)
- [CycleGAN project page](https://junyanz.github.io/CycleGAN/)
- [A Gentle Introduction to CycleGAN for Image Translation](https://machinelearningmastery.com/what-is-cyclegan/)
